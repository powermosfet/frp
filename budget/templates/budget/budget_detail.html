{% extends 'base.html' %}
{% load filters %}

{% block caption %}Budget | {{ block.super }}{% endblock %}

{% block header %}Budget{% endblock %}
{% block appmenu %}
<li><a href="{% url 'budget_main' %}">[budget]</a></li>
<li><a href="">[accounting]</a></li>
{% endblock %}

{% block main %}
      <h3>{{ object }} [{{Â object.timestamp }}]</h3>
      <table class='datagrid'>
        <tr>
          <th>Category</th>
          <th class='currencyDisplay'>Amount</th>
          <th>Payments per year</th>
          <th class='currencyDisplay'>Per month</th>
        </tr>
        {% for rec in object.record_set.all %}
        <tr>
          <td>{{ rec.category }}</td>
          <td class='currencyDisplay'>{{ rec.amount|two_decimals }}</td>
          <td>{{ rec.payments_per_year }}</td>
          <td class='currencyDisplay'>{{ rec.amount_per_month|two_decimals }}</td>
        </tr>
        {% endfor %}
        <tr>
          <td >Result</td>
          <td />
          <td />
            <td class='currencyDisplay'>{{ object.result|two_decimals }}</td>
        </tr>
        <tr>
          <form action='{% url 'record_create' %}' method='POST'>{% csrf_token %}
            <input name='budget' type='hidden' value='{{ object.pk }}' />
            <td>
              <select class='select' class='select' name='category' >
                {% for cat in categories %}
                <option value='{{ cat.pk }}'>{{ cat }}</option>
                {% endfor %}
              </select>
            </td>
            <td class='currencyDisplay'><input name='amount' class='input' type='text' /></td>
            <td><input name='payments_per_year' class='input' type='text' /></td>
            <td class='currencyDisplay'><button type='submit' class='addbutton'>Add</button></td>
          </form>
        </tr>
      </table>
{% endblock %}

{% block side_menu %}
<p>
  <h3>Categories:</h3>
  <ul>
    {% for cat in categories %}
      <li>{{ cat }}</li>
    {% endfor %}
    <li>
      <form action='{% url 'category_create' %}' method ='POST'>{% csrf_token %}
        <select class='select' name='parent' >
          <option value=''></option>
          {% for cat in categories %}
          <option value='{{ cat.pk }}'>{{ cat }}</option>
          {% endfor %}
        </select>
        <input type='text' class='textbox' name='name' />
        <button type='submit' class='addbutton' name='add'>Add</button>
      </form>
    </li>
  </ul>
</p>
<p>
  <h3>Budgets:</h3>
  <ul>
    {% for b in budgets %}
    <a href='{% url 'budget' b.pk %}'><li>{{ b }}</li></a>
    {% endfor %}
    <li>
      <form action='{% url 'budget_create' %}' method ='POST'>{% csrf_token %}
        <input type='text' class='textbox' name='description' />
        <button type='submit' class='addbutton' name='add'>Add</button>
      </form>
    </li>
  </ul>
</p>
{% endblock %}
